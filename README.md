# Telegram Daily Bot

Телеграм-бот для сбора ежедневных текстовых отчётов в групповых чатах. Он автоматически
отправляет сообщение с вопросами, собирает ответы и сохраняет их в базе SQLite. Основной
код расположен в `main.py`.

## Требования

- Бот работает только в группах и супергруппах.
- После добавления в чат выдать права администратора.
- Нужны права: чтение сообщений, отправка сообщений, просмотр списка участников и администраторов.



## Установка и запуск

1. Установите Python 3.11 или новее.
2. Склонируйте репозиторий и установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Создайте файл `.env` с токеном вашего бота:
   ```
   BOT_TOKEN=ваш_токен
   ```
4. Запустите бота командой:
   ```bash
   python main.py
   ```

При первом запуске будет создан файл `bot.db` со всеми таблицами.

## Инструкция для администраторов

### Настройка
- Добавьте бота в группу и дайте ему права администратора.
- Выполните `/start` в чате для инициализации базы.
- Установите время дэйлика по Москве командой `/settime HH:MM`.
- Все команды работают только для администраторов чата.
- Время задавайте по московскому времени (MSK), независимо от часового пояса сервера.
- Чтобы получить chat_id для получения отчёта в личке, используйте /mychats в ЛС боту.


### Основные команды из чата
- `/start` — добавить чат и создать записи в базе.
- `/settime HH:MM` — время отправки дэйлика.
- `/testdaily` — немедленно отправить сообщение дэйлика.
- `/exclude @username|user_id` — исключить пользователя из напоминаний.
- `/include @username|user_id` — вернуть пользователя в активный список.
- `/list_active` — список активных участников.
- `/list_all` — полный список участников со статусом.
- `/report [дата]` — отчёты за указанную дату (по умолчанию — сегодня).
- Через два часа после дэйлика бот проверяет отчёты и отмечает в чате тех, кто
  ещё не ответил.

### Команды в личных сообщениях
- `/mychats` — список ваших чатов.
- `/report chat_id [дата]` — получить отчёты конкретного чата в личку.

Все данные о чатах, участниках и отчётах хранятся в `bot.db`. При необходимости файл можно
архивировать для резервного копирования.

## Инструкция для участников

- Каждый день бот отправляет сообщение с тремя вопросами.
- Чтобы попасть в список активных, один раз ответьте реплаем на сообщение дэйлика.
- Если вас исключили, используйте `/include` или просто снова ответьте на дэйлик.
- Напоминания приходят только активным участникам, если отчёт не сдан вовремя.
  Если вы пропустили дэйлик, бот упомянет вас в чате через два часа после его
  отправки.
- Получить краткую справку можно по команде `/help`.

Для связи с разработчиком — [@Fessan](https://t.me/Fessan).
